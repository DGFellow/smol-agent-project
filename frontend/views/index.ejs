<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/style.css">
    <!-- Optional: Add markdown libraries if needed -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.6/dist/purify.min.js"></script>
</head>
<body>
    <!-- App Shell: Sidebar (left) | Content (right) -->
    <div id="app-shell" class="app-shell">

        <!-- Left column: Sidebar -->
        <%- include('sidebar', { 
            user: typeof user !== 'undefined' ? user : null,
            conversations: typeof conversations !== 'undefined' ? conversations : []
        }) %>

        <!-- Right column: Header + Main + Footer -->
        <div class="app-content">
            <%- include('header') %>

            <!-- Main Wrapper -->
            <div id="main-wrapper" class="main-wrapper">
                <!-- Main Chat Container -->
                <main class="chat-container">
                    <div class="chat-interface">
                        <!-- Messages Area -->
                        <div id="chat-messages" class="messages"></div>

                        <!-- Input Area -->
                        <div class="input-area">
                            <div class="composer">
                                <button type="button" class="icon-btn attach-btn" aria-label="Attach" title="Attach files (coming soon)">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                                        <path d="M16.5 6.5l-7.78 7.78a3 3 0 105.06 3.42l6.36-6.36a5 5 0 10-7.07-7.07L6.1 10.24" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </button>

                                <button type="button" id="clear-btn" class="icon-btn" aria-label="Clear" title="Clear conversation">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                                        <path d="M6 6l12 12M6 18L18 6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
                                    </svg>
                                </button>

                                <textarea
                                    id="message-input"
                                    placeholder="Ask anythingâ€¦"
                                    rows="1"
                                ></textarea>

                                <div class="button-group composer-actions">
                                    <button type="button" id="send-btn" class="send-btn" aria-label="Send">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                                            <path d="M4 12l16-8-5.5 8L20 20l-16-8z" stroke="currentColor" stroke-width="1.4" stroke-linejoin="round"/>
                                        </svg>
                                        <span class="btn-label">Send</span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>

            <%- include('footer') %>
        </div>
    </div>

    <script src="/js/main.js"></script>
</body>
</html>